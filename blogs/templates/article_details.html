{% extends "base.html" %}

{% block title %} 
{{ post.title_tag}} - {{ post.title }} 
{% endblock title %}


{% block content %}

<h1>{{ post.title }}</h1>
<!-- <small>
    by {{ post.author.first_name}} {{ post.author.last_name }} -->
    <br/>
    {% if user.is_authenticated %}
        {% if user.id == 1 %} <!-- Admin -->
            {% if post.author.userprofile.profile_picture %}
            <div class="card mb-3">
                <div class="row g-0">
                  <div class="col-md-2">
                    <img src="{{ post.author.userprofile.profile_picture.url }}" class="rounded" width="200" height="200">
                  </div>
                  <div class="col-md-10">
                    <div class="card-body">
                      <h5 class="card-title">
                        {{ post.author.first_name}} {{ post.author.last_name }}</h5>
                        <p class="card-text">
                            <small class="text-body-secondary">
                                {% if post.author.userprofile.github_url %}
                                    <a href='{{ post.author.userprofile.github_url }}'>GitHub</a>
                                {% endif %}

                                {% if post.author.userprofile.vk_url %} 
                                    | <a href='{{ post.author.userprofile.vk_url }}'>VK</a>
                                {% endif %}

                                {% if post.author.userprofile.steam_url %}
                                    | <a href='{{ post.author.userprofile.steam_url }}'>Steam</a>
                                {% endif %}

                                {% if post.author.userprofile.spotify_url %}
                                    | <a href='{{ post.author.userprofile.spotify_url }}'>Spotify</a>
                                {% endif %}
                            </small>
                        </p>
                      <p class="card-text">
                        I'm a Python and Django enthusiast.
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            {% endif%}
            <a href="{% url 'update_post' post.pk %}">Edit & Update Post</a>
            or
            <a href="{% url 'delete_post' post.pk %}">Delete Post</a>
        
        {% else %}
            {% if user.id == post.author.id %}
                <a href="{% url 'update_post' post.pk %}">Edit & Update Post</a>
                or
                <a href="{% url 'delete_post' post.pk %}">Delete Post</a>
            {% endif %}
        {% endif %}
    {% endif %}
</small>
<br/>
<hr>
<br/>
<!-- The header of the post -->
{% if post.header_image %}
       <img src="{{ post.header_image.url }}">
{% endif%}
<br/><br/>
{{ post.body|safe }}
<br/>
<br/>
<form 
action="{% url 'like_post' post.pk %}"
method="POST">
    {% csrf_token %}
    {% if liked %}
        <button type="submit", name="post_id", value ="post.id", 
        class='btn btn-danger btn-sm'>Dislike</button>
    {% else %}
        <button type="submit", name="post_id", value ="post.id", 
        class='btn btn-primary btn-sm'>Like</button>
    {% endif %}
    - {{ total_likes }} Like(s)
</form>

<br/>
<br/>
<a href="{% url 'home' %}" class="btn btn-primary">Back</a>

{% endblock content %}